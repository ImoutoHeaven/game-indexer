{% extends "layout.html" %}

{% block title %}Search{% endblock %}

{% block content %}
  <h1>Search</h1>
  <form method="get" action="/search">
    <label for="library">Library</label>
    <select id="library" name="library">
      {% if libraries %}
        {% for library in libraries %}
          <option value="{{ library.id }}" {% if selected_library == library.id %}selected{% endif %}>
            {{ library.name }}
          </option>
        {% endfor %}
      {% else %}
        <option value="">No libraries available</option>
      {% endif %}
    </select>

    <label for="embedder">Embedder</label>
    <select id="embedder" name="embedder">
      {% if embedders %}
        {% for embedder in embedders %}
          <option value="{{ embedder.key }}" {% if selected_embedder == embedder.key %}selected{% endif %}>
            {{ embedder.key }}
          </option>
        {% endfor %}
      {% else %}
        <option value="">No embedders available</option>
      {% endif %}
    </select>

    <label for="q">Query</label>
    <input id="q" name="q" type="text" value="{{ query }}">

    <button type="submit">Search</button>
  </form>

  {% if error_message %}
    <p>{{ error_message }}</p>
  {% elif searched and not results %}
    <p>No results</p>
  {% elif results %}
    <ul>
      {% for result in results %}
        <li>{{ result.name }}</li>
      {% endfor %}
    </ul>
  {% endif %}
{% endblock %}
